<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dentist Radar — Admin</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .admin-wrap{max-width:800px;margin:32px auto;padding:16px}
    .card{border:1px solid #e7ecf2;border-radius:12px;padding:16px;background:#fff}
    .row{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
    .row input{flex:1;min-width:220px;height:44px;border:1px solid #e7ecf2;border-radius:10px;padding:0 12px}
    .btn{height:44px;padding:0 16px;border:0;border-radius:10px;background:#2b7fff;color:#fff;font-weight:700;cursor:pointer}
    pre{background:#0e1525;color:#e6edf3;border-radius:10px;padding:12px;overflow:auto}
    .muted{color:#5b6578;font-size:14px;margin-top:6px}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container navbar">
      <div class="nav-left">
        <a class="logo" href="/"><img src="logo.svg" alt="Dentist Radar" /></a>
      </div>
      <div class="nav-right">
        <button id="menu-toggle" class="menu-toggle" aria-label="Menu">☰</button>
        <ul id="nav-links" class="nav-links">
          <li><a href="pricing.html">Pricing</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="terms.html">Terms</a></li>
          <li><a href="privacy.html">Privacy</a></li>
        </ul>
      </div>
    </div>
  </header>

  <main class="admin-wrap">
    <h1>Admin — Manual Scan</h1>
    <div class="card">
      <div class="row">
        <input id="token" placeholder="Scan token" />
        <button id="run" class="btn">Run Scan Now</button>
      </div>
      <div class="muted">Tip: paste your <strong>SCAN_TOKEN</strong> once — it’s stored locally for next time.</div>
      <pre id="out">{ "hint": "Click Run Scan Now" }</pre>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container footer">
      © 2025 Dentist Radar · <a href="privacy.html">Privacy</a> · <a href="terms.html">Terms</a> · <a href="about.html">About</a>
    </div>
  </footer>

  <script>
  (function(){
    const menuBtn = document.getElementById('menu-toggle');
    const nav = document.getElementById('nav-links');
    menuBtn?.addEventListener('click',()=>nav?.classList.toggle('open'));

    const tokenEl = document.getElementById('token');
    const out = document.getElementById('out');
    const run = document.getElementById('run');

    // load saved token
    tokenEl.value = localStorage.getItem('scan_token') || '';

    run.addEventListener('click', async ()=>{
      const token = (tokenEl.value || '').trim();
      if(!token){ out.textContent = JSON.stringify({ok:false,error:'missing_token'}, null, 2); return; }
      localStorage.setItem('scan_token', token);
      out.textContent = 'Running…';

      try{
        const r = await fetch(`/api/scan?token=${encodeURIComponent(token)}`, { method:'POST' });
        const j = await r.json().catch(()=>({ok:false,error:'non_json_response'}));
        out.textContent = JSON.stringify(j, null, 2);
      }catch(e){
        out.textContent = JSON.stringify({ ok:false, error: e?.message || 'network_error' }, null, 2);
      }
    });
  })();
  </script>
</body>
</html>
