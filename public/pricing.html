<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Pricing — Dentist Radar</title>
  <link rel="icon" href="/favicon.svg"/>
  <link rel="stylesheet" href="/style.css"/>
  <style>
    .pricing-wrap{max-width:960px;margin:1.25rem auto;padding:0 12px}
    .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
    .card{background:#fff;border:1px solid #eee;border-radius:10px;padding:18px;text-align:left;display:flex;flex-direction:column}
    .card h2{margin:.25rem 0 .5rem 0}
    .card p{margin:.25rem 0}
    .card .btn,.card .btn-secondary{margin-top:12px;width:100%}
    .pill{color:#1a73e8;font-size:.9rem;margin-left:.25rem}
    .muted{opacity:.75}
    @media(max-width:960px){.grid{grid-template-columns:1fr}}
    label{font-weight:600;margin-top:8px}
    input[type="email"]{padding:.7rem;border:1px solid #ccc;border-radius:8px}
  </style>
</head>
<body>
  <header>
    <nav class="navbar">
      <a href="/" class="logo"><img src="/logo.svg" alt="Dentist Radar"/></a>
      <button class="menu-toggle" id="menu-toggle">☰</button>
      <ul class="nav-links" id="nav-links">
        <li><a class="active" href="/pricing.html">Pricing</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="/terms.html">Terms</a></li>
        <li><a href="/privacy.html">Privacy</a></li>
      </ul>
    </nav>
  </header>

  <main class="hero">
    <h1>Compare plans</h1>
    <p>Start free. Upgrade for more postcodes and faster checks.</p>

    <section class="pricing-wrap">
      <div class="grid">
        <!-- Free -->
        <div class="card">
          <h2>Free</h2>
          <p>• 1 postcode</p>
          <p>• Daily checks</p>
          <p>• Email alerts</p>
          <button class="btn" onclick="location.href='/'">Get started free</button>
        </div>

        <!-- Pro -->
        <div class="card">
          <h2>Pro <span class="pill">£4.99 one-time</span></h2>
          <p>• Up to 5 postcodes</p>
          <p>• Hourly checks</p>
          <p>• Early delivery window</p>
          <label for="proEmail">Your email</label>
          <input id="proEmail" type="email" placeholder="you@example.com" required/>
          <button id="proBtn" class="btn">Upgrade to Pro</button>
          <p id="proMsg" class="message muted"></p>
        </div>

        <!-- Family -->
        <div class="card">
          <h2>Family <span class="pill">£9.99 one-time</span></h2>
          <p>• Up to 12 postcodes (share)</p>
          <p>• Hourly checks</p>
          <p>• Priority notifications</p>
          <label for="famEmail">Your email</label>
          <input id="famEmail" type="email" placeholder="you@example.com" required/>
          <button id="famBtn" class="btn">Go Family</button>
          <p id="famMsg" class="message muted"></p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 Dentist Radar · <a href="/about.html">About</a> · <a href="/privacy.html">Privacy</a> · <a href="/terms.html">Terms</a></p>
  </footer>

  <script>
    // burger
    document.getElementById('menu-toggle')?.addEventListener('click',()=>document.getElementById('nav-links')?.classList.toggle('open'));
    const emailRe=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;

    function bind(plan){
      const btn=document.getElementById(plan+'Btn');
      const inp=document.getElementById(plan==='pro'?'proEmail':'famEmail');
      const msg=document.getElementById(plan==='pro'?'proMsg':'famMsg');
      btn?.addEventListener('click', async ()=>{
        const email=(inp.value||'').trim();
        if(!emailRe.test(email)){ msg.textContent='Please enter a valid email.'; msg.style.color='#d00'; return; }
        msg.textContent='Preparing checkout…'; msg.style.color='#444';
        try{
          const res=await fetch('/api/checkout/'+plan,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});
          const j=await res.json().catch(()=>null);
          if(res.ok && j?.url){ location.href=j.url; }
          else if(j?.error==='stripe_not_configured'){ msg.textContent='Checkout not configured yet. Try later.'; msg.style.color='#d00'; }
          else { msg.textContent='Upgrade failed — try later.'; msg.style.color='#d00'; }
        }catch{ msg.textContent='Network error — try again.'; msg.style.color='#d00'; }
      });
    }
    bind('pro'); bind('family');
  </script>
</body>
</html>
